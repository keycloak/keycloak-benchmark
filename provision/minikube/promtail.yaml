#  https://github.com/grafana/helm-charts/tree/main/charts/promtail

serviceMonitor:
  enabled: true
config:
  clients:
    - url: http://loki.monitoring.svc:3100/loki/api/v1/push
  snippets:
    pipelineStages:
      - cri: {}
      - match:
          selector: '{app="keycloak"}'
          stages:
            - json:
                expressions:
                  log_line: log
            - json:
                expressions:
                  loggerName: loggerName
                  level: level
                source: log_line
            - labels:
                level: level
                loggerName: loggerName
            - replace:
                expression: "(.+)"
                replace: "{{.log_line}}"

